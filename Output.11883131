R[write to console]: Loading required package: nnet

Start time: 2024-11-04 13:05:14
Job ID:  11883131
Training size: %d 10500
8 available workers for ProcessPoolExecutor.
R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

R[write to console]: Loading required package: nnet

config_grid:  {'run_DQlearning': False, 'run_surr_opt': True, 'run_adaptive_contrast_tao': False, 'setting': 'new', 'num_replications': 30, 'sample_size': 15000, 'batch_size': 800, 'n_epoch': 60, 'num_layers': 4, 'optimizer_type': 'adam', 'optimizer_lr': 0.07, 'dropout_rate': 0.4, 'activation_function': 'elu', 'hidden_dim_stage1': 40, 'hidden_dim_stage2': 40, 'gradient_clipping': True, 'add_ll_batch_norm': False, 'phi_ensamble': False, 'ensemble_count': 1, 'C1': 3.0, 'C2': 3.0, 'neu': 5, 'u': 5, 'alpha': 5, 'f': 'square', 'm1': 'sin', 'm2': 'sin', 'input_dim': 100, 'noiseless': False, 'use_m_propen': True, 'interaction_terms': False, 'surrogate_num': 1, 'option_sur': 2, 'device': device(type='cuda'), 'training_validation_prop': 0.7, 'num_networks': 2, 'output_dim_stage1': 1, 'output_dim_stage2': 1, 'optimizer_weight_decay': 0.001, 'use_scheduler': True, 'scheduler_type': 'reducelronplateau', 'scheduler_step_size': 30, 'scheduler_gamma': 0.8, 'initializer': 'he', 'contrast': 1, 'job_id': '11883131', 'gamma1': tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0'), 'gamma2': tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0'), 'gamma1_prime': tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0'), 'gamma2_prime': tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0'), 'delta_A1': tensor([2.0000, 3.0000, 1.5000], device='cuda:0'), 'delta_A2': tensor([2.5000, 1.5000, 3.0000], device='cuda:0'), 'lambda_val': tensor(0.3000), 'eta_A1': tensor([1.0000, 2.5000, 2.0000], device='cuda:0'), 'eta_A2': tensor([2.0000, 1.0000, 2.5000], device='cuda:0')} 


Replications_M1:   0%|                                                                                                                                                                                                                                    | 0/30 [00:00<?, ?it/s]
Replication # -------------->>>>>  1

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 0 0
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 11.534171342849731 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1234 1234
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.25500357151031494 pi_11:  0.4812159836292267 pi_12:  0.2637804448604584
pi_20:  0.26444339752197266 pi_21:  0.25381970405578613 pi_22:  0.481736958026886
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9792, device='cuda:0')
Y2_beh mean:  tensor(3.6404, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6196, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6865, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0904, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7769, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5193, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9601, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4794, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.16628026962280273 seconds

Y1_DS+Y2_DS mean: 9.479408264160156
Total time taken to run eval_DTR: 1.0810496807098389 seconds 


Replications_M1:   3%|███████▎                                                                                                                                                                                                                    | 1/30 [00:16<07:46, 16.08s/it]
Replication # -------------->>>>>  2

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1 1
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.065332889556885 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1235 1235
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.27579233050346375 pi_11:  0.4796459376811981 pi_12:  0.2445617914199829
pi_20:  0.2794763147830963 pi_21:  0.242065891623497 pi_22:  0.47845780849456787
==========================================================================================

============================================================
Y1_beh mean:  tensor(3.0420, device='cuda:0')
Y2_beh mean:  tensor(3.6833, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.7254, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7147, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0848, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7995, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5494, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9581, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5075, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02657604217529297 seconds

Y1_DS+Y2_DS mean: 9.507462501525879
Total time taken to run eval_DTR: 0.04095959663391113 seconds 


Replications_M1:   7%|██████████████▋                                                                                                                                                                                                             | 2/30 [00:26<05:52, 12.57s/it]
Replication # -------------->>>>>  3

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 2 2
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.059452533721924 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1236 1236
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.25705501437187195 pi_11:  0.4827876091003418 pi_12:  0.26015743613243103
pi_20:  0.24590866267681122 pi_21:  0.2710064649581909 pi_22:  0.48308488726615906
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9948, device='cuda:0')
Y2_beh mean:  tensor(3.6575, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6524, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6617, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1525, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8141, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4958, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0305, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5263, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025655269622802734 seconds

Y1_DS+Y2_DS mean: 9.52629566192627
Total time taken to run eval_DTR: 0.03989529609680176 seconds 


Replications_M1:  10%|██████████████████████                                                                                                                                                                                                      | 3/30 [00:36<05:09, 11.45s/it]
Replication # -------------->>>>>  4

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 3 3
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.059577465057373 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1237 1237
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2458583563566208 pi_11:  0.48431751132011414 pi_12:  0.2698241174221039
pi_20:  0.28251829743385315 pi_21:  0.2329995036125183 pi_22:  0.4844822287559509
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9849, device='cuda:0')
Y2_beh mean:  tensor(3.6850, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6699, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6808, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0878, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7686, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5164, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9489, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4653, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026572704315185547 seconds

Y1_DS+Y2_DS mean: 9.465330123901367
Total time taken to run eval_DTR: 0.04072237014770508 seconds 


Replications_M1:  13%|█████████████████████████████▎                                                                                                                                                                                              | 4/30 [00:46<04:43, 10.92s/it]
Replication # -------------->>>>>  5

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 4 4
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.070226192474365 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1238 1238
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2542356550693512 pi_11:  0.48518475890159607 pi_12:  0.2605796158313751
pi_20:  0.25028830766677856 pi_21:  0.26408809423446655 pi_22:  0.4856235980987549
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9949, device='cuda:0')
Y2_beh mean:  tensor(3.6497, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6446, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6711, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1088, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7799, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5045, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9815, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4860, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025552034378051758 seconds

Y1_DS+Y2_DS mean: 9.485998153686523
Total time taken to run eval_DTR: 0.03896594047546387 seconds 


Replications_M1:  17%|████████████████████████████████████▋                                                                                                                                                                                       | 5/30 [00:56<04:25, 10.63s/it]
Replication # -------------->>>>>  6

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 5 5
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.07994270324707 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1239 1239
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2618604302406311 pi_11:  0.4894542396068573 pi_12:  0.24868535995483398
pi_20:  0.259370356798172 pi_21:  0.2515949010848999 pi_22:  0.4890347719192505
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9853, device='cuda:0')
Y2_beh mean:  tensor(3.7002, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6856, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6333, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1305, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7638, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4623, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0080, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4703, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026421308517456055 seconds

Y1_DS+Y2_DS mean: 9.470345497131348
Total time taken to run eval_DTR: 0.040311336517333984 seconds 


Replications_M1:  20%|████████████████████████████████████████████                                                                                                                                                                                | 6/30 [01:06<04:11, 10.46s/it]
Replication # -------------->>>>>  7

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 6 6
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.07645845413208 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1240 1240
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2697092592716217 pi_11:  0.47945934534072876 pi_12:  0.2508314549922943
pi_20:  0.260270893573761 pi_21:  0.2604020833969116 pi_22:  0.4793270230293274
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9763, device='cuda:0')
Y2_beh mean:  tensor(3.6352, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6115, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6685, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1187, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7872, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4990, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9840, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4829, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025541305541992188 seconds

Y1_DS+Y2_DS mean: 9.482937812805176
Total time taken to run eval_DTR: 0.039600372314453125 seconds 


Replications_M1:  23%|███████████████████████████████████████████████████▎                                                                                                                                                                        | 7/30 [01:16<03:58, 10.35s/it]
Replication # -------------->>>>>  8

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 7 7
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.085565567016602 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1241 1241
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.24498213827610016 pi_11:  0.48412182927131653 pi_12:  0.2708961069583893
pi_20:  0.24917614459991455 pi_21:  0.26672759652137756 pi_22:  0.4840962886810303
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9336, device='cuda:0')
Y2_beh mean:  tensor(3.6591, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.5928, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6339, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1091, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7429, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4634, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9842, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4476, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02530527114868164 seconds

Y1_DS+Y2_DS mean: 9.447562217712402
Total time taken to run eval_DTR: 0.03925585746765137 seconds 


Replications_M1:  27%|██████████████████████████████████████████████████████████▋                                                                                                                                                                 | 8/30 [01:26<03:46, 10.28s/it]
Replication # -------------->>>>>  9

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 8 8
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.087300300598145 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1242 1242
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2492416501045227 pi_11:  0.48633241653442383 pi_12:  0.26442593336105347
pi_20:  0.261625200510025 pi_21:  0.2511681616306305 pi_22:  0.4872066378593445
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9491, device='cuda:0')
Y2_beh mean:  tensor(3.7151, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6642, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6398, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1242, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7641, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.3878, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9951, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.3829, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025408506393432617 seconds

Y1_DS+Y2_DS mean: 9.382877349853516
Total time taken to run eval_DTR: 0.03865623474121094 seconds 


Replications_M1:  30%|██████████████████████████████████████████████████████████████████                                                                                                                                                          | 9/30 [01:37<03:34, 10.23s/it]
Replication # -------------->>>>>  10

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 9 9
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.089762449264526 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1243 1243
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2717515826225281 pi_11:  0.4791131615638733 pi_12:  0.24913525581359863
pi_20:  0.25874194502830505 pi_21:  0.261308878660202 pi_22:  0.47994914650917053
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9737, device='cuda:0')
Y2_beh mean:  tensor(3.6369, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6106, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6598, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0999, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7597, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [1, 1]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [1, 1]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [1, 1]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(1.7464, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.1205, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(5.8670, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02541637420654297 seconds

Y1_DS+Y2_DS mean: 5.866950511932373
Total time taken to run eval_DTR: 0.03912091255187988 seconds 


Replications_M1:  33%|█████████████████████████████████████████████████████████████████████████                                                                                                                                                  | 10/30 [01:47<03:24, 10.20s/it]
Replication # -------------->>>>>  11

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 10 10
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.092238664627075 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1244 1244
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.23922370374202728 pi_11:  0.48217034339904785 pi_12:  0.27860599756240845
pi_20:  0.27629491686820984 pi_21:  0.2418908178806305 pi_22:  0.48181429505348206
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9571, device='cuda:0')
Y2_beh mean:  tensor(3.6994, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6565, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6595, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1172, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7767, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4885, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9929, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4815, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026338815689086914 seconds

Y1_DS+Y2_DS mean: 9.481451034545898
Total time taken to run eval_DTR: 0.04026341438293457 seconds 


Replications_M1:  37%|████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                          | 11/30 [01:57<03:13, 10.18s/it]
Replication # -------------->>>>>  12

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 11 11
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.091608762741089 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1245 1245
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2687249481678009 pi_11:  0.4788011908531189 pi_12:  0.252473920583725
pi_20:  0.2642274498939514 pi_21:  0.2575240731239319 pi_22:  0.4782485067844391
==========================================================================================

============================================================
Y1_beh mean:  tensor(3.0171, device='cuda:0')
Y2_beh mean:  tensor(3.6494, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6665, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7161, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1098, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8259, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5541, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9844, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5385, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025533437728881836 seconds

Y1_DS+Y2_DS mean: 9.538518905639648
Total time taken to run eval_DTR: 0.03948354721069336 seconds 


Replications_M1:  40%|███████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                   | 12/30 [02:07<03:03, 10.17s/it]
Replication # -------------->>>>>  13

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 12 12
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.101191282272339 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1246 1246
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2666304409503937 pi_11:  0.4810982346534729 pi_12:  0.2522713541984558
pi_20:  0.2703495919704437 pi_21:  0.24850139021873474 pi_22:  0.48114901781082153
==========================================================================================

============================================================
Y1_beh mean:  tensor(3.0090, device='cuda:0')
Y2_beh mean:  tensor(3.6560, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6650, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6918, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0846, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7763, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5234, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9539, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4772, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02550816535949707 seconds

Y1_DS+Y2_DS mean: 9.477226257324219
Total time taken to run eval_DTR: 0.039508819580078125 seconds 


Replications_M1:  43%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                            | 13/30 [02:17<02:52, 10.16s/it]
Replication # -------------->>>>>  14

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 13 13
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.09067177772522 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1247 1247
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2662718594074249 pi_11:  0.47797781229019165 pi_12:  0.2557503581047058
pi_20:  0.24751071631908417 pi_21:  0.27602776885032654 pi_22:  0.4764615297317505
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9860, device='cuda:0')
Y2_beh mean:  tensor(3.6116, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.5977, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6847, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1011, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7858, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5159, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9723, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4882, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025295257568359375 seconds

Y1_DS+Y2_DS mean: 9.4882230758667
Total time taken to run eval_DTR: 0.03912496566772461 seconds 


Replications_M1:  47%|██████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                    | 14/30 [02:27<02:42, 10.16s/it]
Replication # -------------->>>>>  15

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 14 14
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.107717275619507 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1248 1248
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.24544480443000793 pi_11:  0.4784291088581085 pi_12:  0.27612611651420593
pi_20:  0.2631828486919403 pi_21:  0.25852978229522705 pi_22:  0.47828736901283264
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9975, device='cuda:0')
Y2_beh mean:  tensor(3.6694, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6669, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7242, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1139, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8381, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5576, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9860, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5436, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026602506637573242 seconds

Y1_DS+Y2_DS mean: 9.543558120727539
Total time taken to run eval_DTR: 0.040503501892089844 seconds 


Replications_M1:  50%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                             | 15/30 [02:37<02:32, 10.16s/it]
Replication # -------------->>>>>  16

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 15 15
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.09323239326477 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1249 1249
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2599167227745056 pi_11:  0.4817729890346527 pi_12:  0.2583102583885193
pi_20:  0.26466986536979675 pi_21:  0.25394904613494873 pi_22:  0.4813810884952545
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9744, device='cuda:0')
Y2_beh mean:  tensor(3.6880, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6624, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6596, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1285, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7881, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4959, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9990, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4949, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02583003044128418 seconds

Y1_DS+Y2_DS mean: 9.494874954223633
Total time taken to run eval_DTR: 0.03907370567321777 seconds 


Replications_M1:  53%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                      | 16/30 [02:48<02:22, 10.15s/it]
Replication # -------------->>>>>  17

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 16 16
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.096794366836548 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1250 1250
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2766655683517456 pi_11:  0.48074838519096375 pi_12:  0.24258603155612946
pi_20:  0.26825544238090515 pi_21:  0.25151339173316956 pi_22:  0.4802311956882477
==========================================================================================

============================================================
Y1_beh mean:  tensor(3.0325, device='cuda:0')
Y2_beh mean:  tensor(3.6820, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.7145, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7019, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0998, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8017, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5389, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9718, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5107, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.0253753662109375 seconds

Y1_DS+Y2_DS mean: 9.510708808898926
Total time taken to run eval_DTR: 0.03940606117248535 seconds 


Replications_M1:  57%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                               | 17/30 [02:58<02:11, 10.15s/it]
Replication # -------------->>>>>  18

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 17 17
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.101517915725708 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1251 1251
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.24495194852352142 pi_11:  0.4818238615989685 pi_12:  0.2732241749763489
pi_20:  0.26320284605026245 pi_21:  0.2549283802509308 pi_22:  0.4818687438964844
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9557, device='cuda:0')
Y2_beh mean:  tensor(3.6794, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6351, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6658, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1108, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7766, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4987, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9851, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4838, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025247812271118164 seconds

Y1_DS+Y2_DS mean: 9.48383903503418
Total time taken to run eval_DTR: 0.039281606674194336 seconds 


Replications_M1:  60%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                       | 18/30 [03:08<02:01, 10.15s/it]
Replication # -------------->>>>>  19

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 18 18
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.09400725364685 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1252 1252
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2476881444454193 pi_11:  0.48029962182044983 pi_12:  0.27201229333877563
pi_20:  0.27184343338012695 pi_21:  0.24726566672325134 pi_22:  0.4808909296989441
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9915, device='cuda:0')
Y2_beh mean:  tensor(3.6693, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6608, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7155, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0843, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7998, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5519, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9553, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5073, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026265382766723633 seconds

Y1_DS+Y2_DS mean: 9.507254600524902
Total time taken to run eval_DTR: 0.04024648666381836 seconds 


Replications_M1:  63%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                | 19/30 [03:18<01:51, 10.15s/it]
Replication # -------------->>>>>  20

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 19 19
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.107243776321411 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1253 1253
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2665363550186157 pi_11:  0.4817051291465759 pi_12:  0.25175854563713074
pi_20:  0.26269128918647766 pi_21:  0.2556172013282776 pi_22:  0.48169153928756714
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9890, device='cuda:0')
Y2_beh mean:  tensor(3.6360, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6250, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6550, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1095, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7646, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4878, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9854, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4732, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025280475616455078 seconds

Y1_DS+Y2_DS mean: 9.473158836364746
Total time taken to run eval_DTR: 0.03856945037841797 seconds 


Replications_M1:  67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 20/30 [03:28<01:41, 10.15s/it]
Replication # -------------->>>>>  21

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 20 20
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.102686166763306 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1254 1254
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.26955875754356384 pi_11:  0.4778591990470886 pi_12:  0.25258204340934753
pi_20:  0.23904716968536377 pi_21:  0.2823253273963928 pi_22:  0.4786275029182434
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9548, device='cuda:0')
Y2_beh mean:  tensor(3.6247, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.5795, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6446, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1315, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7761, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4778, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0051, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4829, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025318384170532227 seconds

Y1_DS+Y2_DS mean: 9.482908248901367
Total time taken to run eval_DTR: 0.03899860382080078 seconds 


Replications_M1:  70%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                 | 21/30 [03:38<01:31, 10.15s/it]
Replication # -------------->>>>>  22

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 21 21
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.102301597595215 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1255 1255
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2581396698951721 pi_11:  0.48435741662979126 pi_12:  0.25750288367271423
pi_20:  0.26901909708976746 pi_21:  0.2436446100473404 pi_22:  0.48733633756637573
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9639, device='cuda:0')
Y2_beh mean:  tensor(3.6888, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6526, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6675, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1098, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7772, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5022, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9813, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4835, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025292396545410156 seconds

Y1_DS+Y2_DS mean: 9.483480453491211
Total time taken to run eval_DTR: 0.039012908935546875 seconds 


Replications_M1:  73%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                          | 22/30 [03:48<01:21, 10.15s/it]
Replication # -------------->>>>>  23

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 22 22
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.115915298461914 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1256 1256
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.25616025924682617 pi_11:  0.485691636800766 pi_12:  0.25814810395240784
pi_20:  0.2543724477291107 pi_21:  0.25982365012168884 pi_22:  0.4858039319515228
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9606, device='cuda:0')
Y2_beh mean:  tensor(3.6972, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6578, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6469, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1446, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7915, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4752, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0277, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5029, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02643275260925293 seconds

Y1_DS+Y2_DS mean: 9.502870559692383
Total time taken to run eval_DTR: 0.04048275947570801 seconds 


Replications_M1:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 23/30 [03:59<01:11, 10.15s/it]
Replication # -------------->>>>>  24

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 23 23
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.112634181976318 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1257 1257
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.26139846444129944 pi_11:  0.4798091948032379 pi_12:  0.25879234075546265
pi_20:  0.24530136585235596 pi_21:  0.27561086416244507 pi_22:  0.479087769985199
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9991, device='cuda:0')
Y2_beh mean:  tensor(3.5844, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.5834, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.7030, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0756, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7786, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [3, 3]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [3, 3]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [1, 1]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [1, 1]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(1.1416, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(3.3860, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(4.5276, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02534961700439453 seconds

Y1_DS+Y2_DS mean: 4.527614116668701
Total time taken to run eval_DTR: 0.03915739059448242 seconds 


Replications_M1:  80%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                           | 24/30 [04:09<01:00, 10.16s/it]
Replication # -------------->>>>>  25

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 24 24
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 12.99534010887146 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1258 1258
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.27568477392196655 pi_11:  0.48034900426864624 pi_12:  0.2439662367105484
pi_20:  0.2494705766439438 pi_21:  0.27000290155410767 pi_22:  0.48052656650543213
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9833, device='cuda:0')
Y2_beh mean:  tensor(3.6832, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6665, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6700, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1466, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8166, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5037, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0199, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5235, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025695323944091797 seconds

Y1_DS+Y2_DS mean: 9.523504257202148
Total time taken to run eval_DTR: 0.039808034896850586 seconds 


Replications_M1:  83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                    | 25/30 [04:22<00:55, 11.02s/it]
Replication # -------------->>>>>  26

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 25 25
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.118726968765259 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1259 1259
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.24652735888957977 pi_11:  0.475756973028183 pi_12:  0.27771568298339844
pi_20:  0.2611807584762573 pi_21:  0.2637137770652771 pi_22:  0.4751054644584656
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9451, device='cuda:0')
Y2_beh mean:  tensor(3.6611, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6062, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6628, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1352, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7980, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4971, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0110, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5082, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02565479278564453 seconds

Y1_DS+Y2_DS mean: 9.50815200805664
Total time taken to run eval_DTR: 0.03890275955200195 seconds 


Replications_M1:  87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                             | 26/30 [04:32<00:43, 10.77s/it]
Replication # -------------->>>>>  27

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 26 26
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.104069232940674 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1260 1260
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.26225540041923523 pi_11:  0.47641652822494507 pi_12:  0.2613280713558197
pi_20:  0.2693062722682953 pi_21:  0.2539898157119751 pi_22:  0.4767039120197296
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9635, device='cuda:0')
Y2_beh mean:  tensor(3.6837, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6472, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6596, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1208, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7804, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4888, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9963, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4851, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02529454231262207 seconds

Y1_DS+Y2_DS mean: 9.48509407043457
Total time taken to run eval_DTR: 0.03957819938659668 seconds 


Replications_M1:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 27/30 [04:42<00:31, 10.58s/it]
Replication # -------------->>>>>  28

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 27 27
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.119933843612671 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1261 1261
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.27024346590042114 pi_11:  0.47411540150642395 pi_12:  0.2556411623954773
pi_20:  0.26969313621520996 pi_21:  0.255790114402771 pi_22:  0.47451674938201904
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9690, device='cuda:0')
Y2_beh mean:  tensor(3.6584, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6274, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6505, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1211, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7716, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4855, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9974, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4829, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.025252342224121094 seconds

Y1_DS+Y2_DS mean: 9.482924461364746
Total time taken to run eval_DTR: 0.03852224349975586 seconds 


Replications_M1:  93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍              | 28/30 [04:52<00:20, 10.46s/it]
Replication # -------------->>>>>  29

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 28 28
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.105756521224976 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1262 1262
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.2545660138130188 pi_11:  0.48410871624946594 pi_12:  0.26132526993751526
pi_20:  0.2567126750946045 pi_21:  0.2600826621055603 pi_22:  0.4832046926021576
==========================================================================================

============================================================
Y1_beh mean:  tensor(2.9779, device='cuda:0')
Y2_beh mean:  tensor(3.6885, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6664, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6523, device='cuda:0')
Y2_g2_opt mean:  tensor(5.1641, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.8164, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.4847, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(5.0453, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.5300, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.02501845359802246 seconds

Y1_DS+Y2_DS mean: 9.53003978729248
Total time taken to run eval_DTR: 0.03887748718261719 seconds 


Replications_M1:  97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋       | 29/30 [05:02<00:10, 10.37s/it]
Replication # -------------->>>>>  30

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 29 29
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

Training started!

***************************************** Train -> Agent #: 0*****************************************

Total time taken to run surr_opt: 10.108872413635254 seconds
Evaluation started

 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
config_seed,  replication_seed, seed_value:  0 1263 1263
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 
 SEED ::::::::::------------------------------>>>>>>>>>>>>>>>>> 

==========================================================================================
pi_10:  0.27286332845687866 pi_11:  0.48628225922584534 pi_12:  0.2408544272184372
pi_20:  0.24909967184066772 pi_21:  0.2639572322368622 pi_22:  0.4869430959224701
==========================================================================================

============================================================
Y1_beh mean:  tensor(3.0171, device='cuda:0')
Y2_beh mean:  tensor(3.6499, device='cuda:0')
Y1_beh+Y2_beh mean:  tensor(6.6670, device='cuda:0')

Unique- Optimal treat Stage 1 tensor([1, 2], device='cuda:0')
Unique- Optimal treat Stage 2 tensor([2, 3], device='cuda:0')

Y1_g1_opt mean:  tensor(4.6750, device='cuda:0')
Y2_g2_opt mean:  tensor(5.0931, device='cuda:0')
Y1_g1_opt+Y2_g2_opt mean:  tensor(9.7681, device='cuda:0')
============================================================

***************************************** Test -> Agent #: 0*****************************************


Top 20 Ensemble Predictions and Majority Votes for A1 (stacked format):
Sample 1:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 2:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 3:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 4:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 5:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 6:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 7:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 8:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 9:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 10:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 11:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 12:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 13:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 14:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 15:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 16:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 17:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 18:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 19:
  Ensemble A1 predictions + Voted A1 action: [2, 2]
Sample 20:
  Ensemble A1 predictions + Voted A1 action: [2, 2]

Top 20 Ensemble Predictions and Majority Votes for A2 (stacked format):
Sample 1:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 2:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 3:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 4:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 5:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 6:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 7:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 8:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 9:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 10:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 11:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 12:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 13:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 14:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 15:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 16:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 17:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 18:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 19:
  Ensemble A2 predictions + Voted A2 action: [3, 3]
Sample 20:
  Ensemble A2 predictions + Voted A2 action: [3, 3]

============================================================
Method Name:  DS
Estimated torch.mean(Y1_di): tensor(4.5119, device='cuda:0')
Estimated torch.mean(Y2_di): tensor(4.9652, device='cuda:0')
Estimated torch.mean(Y1_di + Y2_di): tensor(9.4770, device='cuda:0')
============================================================


Total time taken to run evaluate_method ('DS'): 0.026306867599487305 seconds

Y1_DS+Y2_DS mean: 9.477028846740723
Total time taken to run eval_DTR: 0.03976082801818848 seconds 


Replications_M1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [05:13<00:00, 10.30s/it]Replications_M1: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 30/30 [05:13<00:00, 10.44s/it]
Configuration {}, replication 0 completed successfully.
Performances for configuration: %s {}
performance_DQL_mean: %s nan
performance_DS_mean: %s 9.20391845703125
performance_Tao_mean: %s nan




Behavioral Value Functions across all simulations:
Configuration 1: [6.61957311630249, 6.725379943847656, 6.652355194091797, 6.669863700866699, 6.644584655761719, 6.685569763183594, 6.611530303955078, 6.592789649963379, 6.664214134216309, 6.610628604888916, 6.656487464904785, 6.6664958000183105, 6.6649603843688965, 6.597671031951904, 6.666916370391846, 6.662397861480713, 6.714504241943359, 6.635124206542969, 6.660770416259766, 6.625014781951904, 6.579493999481201, 6.652626037597656, 6.657792091369629, 6.583439350128174, 6.666472911834717, 6.606228351593018, 6.647238254547119, 6.62737512588501, 6.666367053985596, 6.666966915130615]


Optimal Value Functions across all simulations:
Configuration 1: [9.776925086975098, 9.799490928649902, 9.81413745880127, 9.76860237121582, 9.779925346374512, 9.763751983642578, 9.787248611450195, 9.742945671081543, 9.764065742492676, 9.759650230407715, 9.776688575744629, 9.82592487335205, 9.776347160339355, 9.785834312438965, 9.838091850280762, 9.788070678710938, 9.801742553710938, 9.776597023010254, 9.79979133605957, 9.764564514160156, 9.776123046875, 9.777202606201172, 9.79151439666748, 9.778585433959961, 9.816597938537598, 9.798025131225586, 9.780360221862793, 9.77156925201416, 9.816384315490723, 9.768061637878418]


DQL Value Functions across all simulations:
Configuration 1: [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]


DS Value Functions across all simulations:
Configuration 1: [9.479408264160156, 9.507462501525879, 9.52629566192627, 9.465330123901367, 9.485998153686523, 9.470345497131348, 9.482937812805176, 9.447562217712402, 9.382877349853516, 5.866950511932373, 9.481451034545898, 9.538518905639648, 9.477226257324219, 9.4882230758667, 9.543558120727539, 9.494874954223633, 9.510708808898926, 9.48383903503418, 9.507254600524902, 9.473158836364746, 9.482908248901367, 9.483480453491211, 9.502870559692383, 4.527614116668701, 9.523504257202148, 9.50815200805664, 9.48509407043457, 9.482924461364746, 9.53003978729248, 9.477028846740723]


Tao Value Functions across all simulations:
Configuration 1: [None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None, None]

Data saved successfully in the folder: %s data/11883131

Unique values for DQL:
Predicted: {'Predicted_A1': set(), 'Predicted_A2': set()}


Unique values for DS:
Predicted: {'Predicted_A1': {1, 2, 3}, 'Predicted_A2': {1, 2, 3}}

TrainVval Plot for Direct search saved as: data/11883131/run_trainVval_0_directSearch.png



<<<<<<<<<<<<<<<<<<<<<<<<<<<--------------------------------------------------->>>>>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<-----------------------FINAL RESULTS------------------------>>>>>>>>>>>>>>>>>>>>>>>
<<<<<<<<<<<<<<<<<<<<<<<<<<<--------------------------------------------------->>>>>>>>>>>>>>>>>>>>>>>>>>>
Configuration: %s
Average Performance:
 %s
 {} {
    "Behavioral": {
        "Method's Value fn.": 6.646028137207031,
        "Method's Value fn. SD": 0.0351864315172397
    },
    "Optimal": {
        "Method's Value fn.": 9.785493977864583,
        "Method's Value fn. SD": 0.021348904715360637
    },
    "DQL": {
        "Method's Value fn.": NaN,
        "Method's Value fn. SD": NaN
    },
    "DS": {
        "Method's Value fn.": 9.20391845703125,
        "Method's Value fn. SD": 1.103640822255825
    },
    "Tao": {
        "Method's Value fn.": NaN,
        "Method's Value fn. SD": NaN
    }
}
End time: 2024-11-04 13:11:15
Total time taken: 360.77 seconds
